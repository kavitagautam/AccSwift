<div class="row">
  <div class="col-md-12 col-xs-12" style="margin-top: 18px">
    <div class="move-right">
      <button
        class="btn btn-default mr-2 mt-2"
        tooltip="Generate Pdf"
        (click)="pdf.saveAs('customer-invoice.pdf')"
      >
        <i class="{{ iconConst.EXPORT_TO_PDF }}"></i>
      </button>
      <button
        class="btn btn-default mr-2 mt-2"
        tooltip="CSV Export"
        (click)="exportToCSV()"
      >
        <i class="{{ iconConst.EXPORT_TO_CSV }}"></i>
      </button>
      <button
        class="btn btn-default mr-2 mt-2"
        tooltip="Print"
        printSectionId="print-section"
        ngxPrint
        [useExistingCss]="true"
      >
        <i class="{{ iconConst.PRINT }}"></i>
      </button>
      <button class="btn btn-default mr-2 mt-2" tooltip="Email">
        <i class="{{ iconConst.EMAIL }}"></i>
      </button>
    </div>
  </div>
</div>

<kendo-pdf-export
  #pdf
  paperSize="A6"
  margin="1cm"
  [scale]="0.8"
  [repeatHeaders]="true"
>
  <div id="print-section">
    <table
      *ngIf="reportType == 'CASH_FLOW'"
      id="header-fixed"
      class="table table-hover table-fixed"
      style="width: 80%"
      align="center"
    >
      <thead>
        <tr>
          <th colspan="1">Account Name</th>
          <th colspan="1">Amount Inflow</th>
          <th colspan="1">Amount Outflow</th>
        </tr>
      </thead>
      <tbody *ngFor="let cashFlow of cashFlowPreview; index as i">
        <tr>
          <!-- <h1>{{ cashFlow.Type === "GROUP" }}</h1> -->
          <td>
            <span
              *ngIf="cashFlow.Level === 0 && cashFlow.Type === 'GROUP'"
              class="group_name"
            >
              {{ cashFlow.AccountName }}
            </span>
            <span
              *ngIf="cashFlow.Level === 1 && cashFlow.Type === 'GROUP'"
              class="group_name"
              style="margin-left: 20px"
            >
              {{ cashFlow.AccountName }}
            </span>
            <span
              *ngIf="cashFlow.Level === 2 && cashFlow.Type === 'GROUP'"
              class="group_name"
              style="margin-left: 30px"
            >
              {{ cashFlow.AccountName }}
            </span>
            <span style="color: blue" *ngIf="cashFlow.Type === 'LEDGER'">
              {{ cashFlow.AccountName }}
            </span>
          </td>
          <td class="balance">
            <span [innerHTML]="cashFlow.InFlowAmount | currencyFormat"></span>
          </td>
          <td class="balance">
            <span [innerHTML]="cashFlow.OutFlowAmount | currencyFormat"></span>
          </td>
        </tr>
      </tbody>
      <tbody *ngIf="cashFlowPreview.length == 0">
        <tr>
          <td colspan="10" align="center">No Data Available</td>
        </tr>
      </tbody>

      <tfoot *ngIf="cashFlowPreview.length > 0">
        <tr>
          <td>Total CashFlow</td>
          <td class="balance">
            <span [innerHTML]="totalInFlowAmount | currencyFormat"></span>
          </td>

          <td class="balance">
            <span [innerHTML]="totalOutFlowAmount | currencyFormat"></span>
          </td>
        </tr>
      </tfoot>
    </table>
  </div>
</kendo-pdf-export>
